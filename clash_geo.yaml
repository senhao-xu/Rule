mixed-port: 7890
allow-lan: true
bind-address: '*'
mode: rule
log-level: info
ipv6: false
unified-delay: true
tcp-concurrent: true
external-controller: 127.0.0.1:9090


# 用于下载订阅时指定UA
global-ua: clash

geodata-mode: true
geodata-loader: standard
geo-auto-update: true
geo-update-interval: 48
geox-url:
  geosite: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat"
  geoip: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat"

# 组策略-管理面板-网络-DNS客户端-禁用智能多宿主名称解析（修改为已启用）
# chrome://flags/ - Experimental QUIC protocol - 关闭   （关闭quic-udp）
# 开启TUN模式中的严格路由
dns:
  enable: true
  listen: 0.0.0.0:53
  ipv6: false
  prefer-h3: false
  respect-rules: true
  use-system-hosts: false
  cache-algorithm: arc
  cache-size: 2048
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - '*.senhao.xyz'
    - 'geosite:private'
    - 'geosite:cn'
    - 'geosite:geolocation-!cn'
  default-nameserver:
    - 223.5.5.5
    - 1.2.4.8
# 默认的域名解析服务器，如不配置 fallback/proxy-server-nameserver , 则所有域名都由 nameserver 解析
  nameserver:
    - https://cloudflare-dns.com/dns-query#Proxy # CloudflareDNS
    - https://8.8.8.8/dns-query#Proxy # Google公共DNS
    - https://8.8.4.4/dns-query#Proxy # Google公共DNS
# 代理节点域名解析服务器，仅用于解析代理节点的域名
  proxy-server-nameserver:
    - https://223.5.5.5/dns-query # 阿里DoH
    - https://doh.pub/dns-query # 腾讯DoH
  direct-nameserver:
    - https://223.5.5.5/dns-query # 阿里DoH
    - https://doh.pub/dns-query # 腾讯DoH
# 指定域名查询的解析服务器，可使用 geosite, 优先于 nameserver/fallback 查询
  direct-nameserver-follow-policy: false
  nameserver-policy:
    'geosite:cn':
      - https://223.5.5.5/dns-query # 阿里DoH
      - https://doh.pub/dns-query # 腾讯DoH

proxy-providers:
  P1:
    type: http
    path: ./gougou.yaml
    url: "https://gougou.fff.so/api/v1/client/subscribe?token=b511ebde64207c4902a2ab87b1a35334"
    interval: 3600
    proxy: DIRECT
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300


# mihomo party 覆写部分 ↓
# https://mihomo.party/docs/guide/override/yaml
proxy-groups:
  - name: AutoSelect
    type: url-test
    url: http://www.gstatic.com/generate_204
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Auto.png
    interval: 300
    filter: "(香港|日本|新加坡)"
    # include-all: true
    use:
      - P1

  - name: Proxy
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Global.png
    proxies:
      - AutoSelect
    # include-all: true
    use:
      - P1

  - name: OpenAi
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/ChatGPT.png
    filter: "(GPT|美国)"
    # include-all: true
    use:
      - P1

  - name: Others
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Final.png
    proxies:
      - Proxy
      - DIRECT

domain_rule: &domain_rule
  type: http
  behavior: domain
  format: text
  interval: 86400

rule-providers:
  reject-list:
    <<: *domain_rule
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/v2ray-rules-dat@release/reject-list.txt
    path: ./ruleset/reject-list.txt

rules:
  - DOMAIN-SUFFIX,senhao.xyz,DIRECT
  
  - GEOSITE,category-ads-all,REJECT
  - GEOSITE,private,DIRECT
  - GEOSITE,youtube,Proxy
  - GEOSITE,google,Proxy
  - GEOSITE,github,Proxy
  - GEOSITE,twitter,Proxy
  - GEOSITE,pixiv,Proxy
  - GEOSITE,category-scholar-!cn,Proxy
  - GEOSITE,category-ai-!cn,OpenAi
  - GEOSITE,biliintl,Proxy
  - GEOSITE,onedrive,DIRECT
  - GEOSITE,microsoft,DIRECT
  - GEOSITE,apple-cn,DIRECT
  - GEOSITE,steam@cn,DIRECT
  - GEOSITE,category-games@cn,DIRECT
  - GEOSITE,geolocation-!cn,Proxy
  - GEOSITE,cn,DIRECT

  #GEOIP 规则
  - GEOIP,private,DIRECT,no-resolve
  - GEOIP,telegram,Proxy,no-resolve
  - GEOIP,google,Proxy,no-resolve
  - GEOIP,lan,DIRECT,no-resolve
  - GEOIP,CN,DIRECT
  - MATCH,Others
